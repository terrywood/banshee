package cn.skypark.code;


import java.awt.image.BufferedImage;

public class Code_guojin extends Code_aa {
    public Code_guojin() {
    }

    String[] getModel() {
        String[] model = new String[]{"11111111111111111111111111111111111111111111000001111111001110011111100111001111100111110011110011111001111001111100111100111110011110011111001111001111100111100111110011111001110011111100111001111111000001111111111111111111111111111111111111111111111111111111", "11111111111111111111111111111111111111111111000011111111000001111111111100111111111110011111111111001111111111100111111111110011111111111001111111111100111111111110011111111111001111111111100111111110000000111111111111111111111111111111111111111111111111111111", "11111111111111111111111111111111111111111100000011111110111100111111111111001111111111100111111111110011111111110011111111111001111111111001111111111001111111111001111111111001111111111001111111111100000000111111111111111111111111111111111111111111111111111111", "11111111111111111111111111111111111111111110000001111111111110001111111111100111111111110011111111110011111111000011111111111100111111111111001111111111100111111111110011111111111001111011111001111100000001111111111111111111111111111111111111111111111111111111", "11111111111111111111111111111111111111111111111000111111111100011111111101001111111100100111111110110011111110011001111111011100111111001110011111001111001111100000000001111111110011111111111001111111111100111111111111111111111111111111111111111111111111111111", "11111111111111111111111111111111111111111110000000111111001111111111100111111111110011111111111000000111111101111001111111111110011111111111001111111111100111111111110011111111111001111011111001111100000011111111111111111111111111111111111111111111111111111111", "11111111111111111111111111111111111111111111100000111111100111111111100111111111100111111111110010000111111000111001111100011110011110011111001111001111100111100111110011111001111001111100111001111111000001111111111111111111111111111111111111111111111111111111", "11111111111111111111111111111111111111111100000000111111111110011111111110011111111111001111111111100111111111100111111111110011111111111011111111111001111111111100111111111110111111111110011111111111001111111111111111111111111111111111111111111111111111111111", "11111111111111111111111111111111111111111111000001111110001110001111001111100111100111110011111001110011111111000111111110011100111110011111001111001111100111100111110011110011111001111100111001111111000001111111111111111111111111111111111111111111111111111111", "11111111111111111111111111111111111111111111000011111111001110011111001111101111100111110011110011111001111001111100111110011100011111100001001111111111100111111111110011111111110011111101110011111110000011111111111111111111111111111111111111111111111111111111"};
        return model;
    }

    int getCode(BufferedImage image, String[] model) {
        String sModel = "";
        int iRet = 0;

        int max_match;
        for(int id = 0; id < image.getHeight(); ++id) {
            for(int x = 0; x < image.getWidth(); ++x) {
                max_match = this.pixelConvert(image.getRGB(x, id));
                sModel = sModel + max_match;
            }
        }

        long var11 = System.currentTimeMillis();
        max_match = 0;

        for(int i = 0; i < 10; ++i) {
            if(sModel.length() == model[i].length()) {
                int match = 0;

                for(int k = 0; k < sModel.length(); ++k) {
                    if(sModel.charAt(k) == model[i].charAt(k)) {
                        ++match;
                    }
                }

                if(match > max_match) {
                    max_match = match;
                    iRet = i;
                }
            }
        }

        return iRet;
    }

    public String getCode(BufferedImage image) {
        String sCode = "";
        String[] model = this.getModel();
        BufferedImage[] checkCode = new BufferedImage[4];
        int height = image.getHeight();
        int width = image.getWidth();
        if(width == 60) {
            int w = width / checkCode.length - 2;
            checkCode[0] = image.getSubimage(0 * w + 4, 0, w, height);
            checkCode[1] = image.getSubimage(1 * w + 4, 0, w, height);
            checkCode[2] = image.getSubimage(2 * w + 4, 0, w, height);
            checkCode[3] = image.getSubimage(3 * w + 4, 0, w, height);

            for(int t = 0; t < 4; ++t) {
                int iCode = this.getCode(checkCode[t], model);
                sCode = sCode + iCode;
            }
        }

        return sCode;
    }
}
